CPU Protection Rings

CPU도 권한 모드라는 것을 가지고 있다.
- 사용자 모드(user mode by application )
- 커널 모드(kernel mode by OS) : 특권 명령어 실행과 원하는 작업 수행을 위한 자원 접근을 가능케 하는 모드


보통 0 ~ 3까지 4가지 모드를 제공함

대부분의 운영체제는 Ring0커널 모드와 Ring3 사용자 모드만 제공.

# 쉬어가기
kernel 이란?
OS에서는, 핵심 기술, 핵심 소프트웨어를 일컬음.

shell이란?
OS는 kernel(알맹이, 핵심), 이를 둘러싼 껍데기가 Shell
 
# 두 가지 모드
사용자모드 : 응용 프로그램이 사용
커널 모드 : OS가 사용






시스템 콜(시스템 호출 인터페이스)은 커널 영역에서 실행함.

커널 모드에서만 실행 가능한 기능들이 있음
커널 모드로 실행하려면, 반드시 시스템 콜을 사용해야 함
시스템 콜은 운영체제가 제공

커널 모드에서만 실행가능한 기능 : 응용프로그램 > 시스템콜 > 커널모드 > CPU 실행
사용자 모드에서 가능한 기능 : 응용프로그램 > CPU실행
함부로 응용 프로그램이 전체 컴퓨터 시스템을 해치지 못함
주민등록 등본은 꼭 동사무소 또는 민원 24시에서(응용 프로그램) 특별한 신청서(시스템 콜)를 써야지만 발급가능한 것과 유사한 원리.
동사무소 직원분들은 특별한 권한을 가지고 주민등록등본 출력 명령을 실행 : 커널모드

# 쉬어가기

응용 프로그래머 : API를 통해 응용 프로그램 개발
시스템 프로그래머 : shell / API / System Call / 하드웨어


파일은 '저장 매체'에 존재. ( 하드웨어 ) >> OS가 관리해야 함
open이라는 함수는 API 일수도, System call일 수도.
이 함수를 만나면 사용자 모드에서 커널 모드로 전환
open 함수를 처리하기 위한 sys open함수( OS 내에 존재 ) 호출
읽혀진 데이타/결과값을 사용자 모드로 전환해 응용프로그램이나 사용자에게 전달




open이라는 함수는 unistd.h 라이브러리 내에 존재
API
System call 내의 systemcall을 처리하는 운영체제 함수

# 정리
운영체제는 시스템 콜을 제공
프로그래밍 언어별로 운영체제 기능을 활용하기 위해, 시스템 콜을 기반으로 API 제공
응용 프로그램은 운영체제 기능 필요시, 해당 API를 사용해서 프로그램을 작성
응용 프로그램이 실행되서, 운영체제 기능이 필요한 API를 호출하면, 시스템 콜이 호출되서, 커널 모드로 변경되어 OS 내부에서 해당 명령이 실행되고, 다시 응용 프로그램으로 돌아간다
